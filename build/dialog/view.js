import*as e from"@wordpress/interactivity";var t={d:(e,o)=>{for(var n in o)t.o(o,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:o[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t)};const o=(i={getContext:()=>e.getContext,getElement:()=>e.getElement,store:()=>e.store,withScope:()=>e.withScope},s={},t.d(s,i),s),{VideoPressIframeApi:n}=window;var i,s;const{actions:r,state:l}=(0,o.store)("prc-block/dialog",{state:{get id(){const e=(0,o.getContext)();return e?.id},get type(){const{id:e}=(0,o.getContext)();return l[e].type},get activationTimerDuration(){const{id:e}=(0,o.getContext)();return l[e].activationTimerDuration},get animationDuration(){const{id:e}=(0,o.getContext)();return l[e].animationDuration},get dialogElement(){const{id:e}=(0,o.getContext)();return document.getElementById(l[e].dialogElemId)},get widths(){const{id:e}=(0,o.getContext)();return l[e].widths},get isOpen(){const{id:e}=(0,o.getContext)();return l[e].isOpen},get isClosing(){const{id:e}=(0,o.getContext)();return l[e].isClosing},get isMobile(){return"mobile"===l.currentDevice},get isVideo(){const{id:e}=(0,o.getContext)();return!!l[e].videoPressAPI},get videoPressAPI(){const{id:e}=(0,o.getContext)();return l[e].videoPressAPI}},actions:{closeAll:(e=null)=>{Object.keys(l).forEach((t=>{if("object"!=typeof l[t]||!l[t].hasOwnProperty("isOpen")||!l[t].hasOwnProperty("type"))return;const o=t;e&&e!==l[o].type||(l[o].isOpen=!1,r.pause(o))}))},onClickOpen:e=>{e.preventDefault();const{id:t}=l;r.open(t)},onClickClose:e=>{e.preventDefault();const{id:t}=l;r.close(t)},open:(e=!1)=>{let t=e;t||(t=l.id),t?(l[t].isOpen=!0,l[t].closingModal=!1,l.videoPressAPI&&setTimeout((0,o.withScope)((()=>{r.play(t)})),l[t].animationDuration)):console.error("No id found to open dialog.")},close:(e=!1)=>{let t=e;t||(t=l.id),t?(l[t].isOpen=!1,l[t].videoPressAPI&&r.pause(t)):console.error("No id found to close dialog.")},play:e=>{e&&l[e].videoPressAPI&&l[e].videoPressAPI.controls.play()},pause:e=>{e&&l[e].videoPressAPI&&l[e].videoPressAPI.controls.pause()}},callbacks:{getStyle:()=>{const{widths:e,currentDevice:t,animationDuration:o}=l;return e[t]?`--min-width: ${e[t]}px; --animation-duration: ${o}ms;`:""},onInitIdentifyDialogElem:()=>{const{id:e}=l,{ref:t}=(0,o.getElement)(),n=t.querySelector(".wp-block-prc-block-dialog-element"),i=n?.getAttribute("id");l[e].dialogElemId=i,console.log("OnInit",l)},onESCKey:e=>{const{id:t,isOpen:o}=l;t&&"Escape"===e.key&&!0===o&&(e.preventDefault(),r.close(t))},onOpen:()=>{const{dialogElement:e,isOpen:t,id:o,type:n}=l;o&&e&&t&&(function(e){const t=new URL(window.location.href);t.searchParams.set("dialogId",e),window.history.pushState({},"",t)}(o),"modal"===n?e.showModal():e.show())},onClose:()=>{console.log("running dialog onClose");const{dialogElement:e,isOpen:t,id:n,animationDuration:i}=l;n&&e?t?console.log("onClose -> isOpen"):(l[n].isClosing=!0,setTimeout((0,o.withScope)((()=>{e.close(),function(){const e=new URL(window.location.href);e.searchParams.delete("dialogId"),window.history.pushState({},"",e)}();const t=new CustomEvent("prc-block-dialog-closed",{detail:{id:n}});console.log("I have fired the event",t),document.dispatchEvent(t),l[n].isClosing=!1})),i)):console.log("onClose -> no id or dialogElement")},onResize:()=>{const e=document.documentElement.clientWidth;l.currentDevice=e<=600?"mobile":e>600&&e<=782?"tablet":"desktop"},onBackdropClick:e=>{const{ref:t}=(0,o.getElement)(),n=t.getBoundingClientRect();if(e.clientX>=n.left&&e.clientX<=n.right&&e.clientY>=n.top&&e.clientY<=n.bottom)return;if(!0!==l.isOpen)return;const{id:i}=l;console.log("onBackdropClick -> close",e,t,l,i),r.close(i)},onAutoActivation:()=>{const{id:e,activationTimerDuration:t}=l;console.log("onAutoActivation",e,t,l),e&&t&&1<=t&&setTimeout((0,o.withScope)((()=>{console.log("onAutoActivation -> closeAll",e),r.closeAll("modal"),r.open(e)})),t)},onVideoPressInit:()=>{const{ref:e}=(0,o.getElement)(),t=e.querySelector(".jetpack-videopress-player");if(!t)return;const i=t.querySelector("iframe");if(!i)return;if(!n)return;const{id:s}=l;l[s].videoPressAPI=n(i,(()=>{api.customize.set({shareButton:!1})}))}}});
//# sourceMappingURL=view.js.map