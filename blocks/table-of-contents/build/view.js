import*as t from"@wordpress/interactivity";var e={d:(t,o)=>{for(var r in o)e.o(o,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:o[r]})},o:(t,e)=>Object.prototype.hasOwnProperty.call(t,e)};const o=(l={getContext:()=>t.getContext,getElement:()=>t.getElement,store:()=>t.store},c={},e.d(c,l),c),{actions:r,state:n}=(0,o.store)("prc-block/table-of-contents",{state:{get chapterEls(){return n.chaptersWatchList.map((t=>document.getElementById(t.id)))}},actions:{getInternalChaptersList:()=>{const{ref:t}=(0,o.getElement)();return t.querySelector(".wp-block-prc-block-table-of-contents__list .is-top-level")?t.querySelector(".wp-block-prc-block-table-of-contents__list"):t.querySelector(".wp-block-prc-block-table-of-contents__list .wp-block-prc-block-table-of-contents__list")},initSmoothScrollClickHandler:()=>{const t=r.getInternalChaptersList();if(!t)return;const e=t.querySelectorAll("a");e&&e.forEach((t=>{t.addEventListener("click",(e=>{const o=t.getAttribute("href");if(0===o.indexOf("#")){e.preventDefault();const t=document.getElementById(o.replace("#",""));t&&(t.scrollIntoView({behavior:"smooth"},!0),window.history.pushState(null,null,o))}}))}))},onDropdownClick:t=>{t.preventDefault();const e=(0,o.getContext)();e.isDropdownOpen=!e.isDropdownOpen}},callbacks:{onInit:()=>{const t=(0,o.getContext)(),{ref:e}=(0,o.getElement)();r.initSmoothScrollClickHandler();const{showCurrentChapter:l}=t;if(!0===l){const{postId:t}=n,e=n.chapters.find((e=>e.id===t))||{},o=e?.internal_chapters||[];n.enableWatchForChapterScroll=!0,n.chaptersWatchList=o}},onResize:()=>{const t=(0,o.getContext)(),{autoDropdownEnabled:e,autoDropdownWidth:r}=t;if(!e)return;const{ref:n}=(0,o.getElement)(),l=n.offsetWidth;t.isDropdown=!!(l<r&&e)},isListItemActive:()=>{const t=(0,o.getElement)(),{ref:e}=t,r=e?.getAttribute("data-ref-value")?.replace("#","");return r===n.currentChapter},watchForChapterScroll:()=>{if(!n.enableWatchForChapterScroll)return;let{currentChapter:t,chapterEls:e}=n;const o=window.scrollY;((r,l)=>{let c;return function(...r){clearTimeout(c),c=setTimeout((()=>{c=null,(()=>{if(t=null,e&&0!==e.length)for(let r=e.length-1;r>=0;r--){const l=e[r].offsetTop;if(o>l){t=e[r].id,t!==n.currentChapter&&(n.currentChapter=t);break}}})(...r)}),300)}})()()},onWindowClick:t=>{const e=(0,o.getContext)(),{ref:r}=(0,o.getElement)();!r.contains(t.target)&&e.isDropdown&&(e.isDropdownOpen=!1)}}});var l,c;
//# sourceMappingURL=view.js.map