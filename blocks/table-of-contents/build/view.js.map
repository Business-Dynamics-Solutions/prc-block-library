{"version":3,"file":"view.js","mappings":"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","sources":["webpack://table-of-contents/webpack/bootstrap","webpack://table-of-contents/webpack/runtime/define property getters","webpack://table-of-contents/webpack/runtime/hasOwnProperty shorthand","webpack://table-of-contents/external module \"@wordpress/interactivity\"","webpack://table-of-contents/./src/view.js"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","var x = (y) => {\n\tvar x = {}; __webpack_require__.d(x, y); return x\n} \nvar y = (x) => (() => (x))\nconst __WEBPACK_NAMESPACE_OBJECT__ = x({ [\"getContext\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getContext), [\"getElement\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.getElement), [\"store\"]: () => (__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__.store) });","/**\n * WordPress Dependencies\n */\nimport { store, getContext, getElement } from '@wordpress/interactivity';\n\nconst { actions, state } = store('prc-block/table-of-contents', {\n\tstate: {\n\t\tget chapterEls() {\n\t\t\tconst internalChaptersList = state.chaptersWatchList;\n\t\t\tconst chapterEls = internalChaptersList.map((chapter) => {\n\t\t\t\tconst chapterRef = document.getElementById(chapter.id);\n\t\t\t\treturn chapterRef;\n\t\t\t});\n\t\t\treturn chapterEls;\n\t\t},\n\t},\n\tactions: {\n\t\tgetInternalChaptersList: () => {\n\t\t\tconst { ref } = getElement();\n\t\t\t// check if the first level of the list has list-items with is-top-level class\n\t\t\t// if so, return the first level of the list\n\t\t\tif (\n\t\t\t\tref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list .is-top-level'\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\treturn ref.querySelector(\n\t\t\t\t\t'.wp-block-prc-block-table-of-contents__list'\n\t\t\t\t);\n\t\t\t}\n\t\t\treturn ref.querySelector(\n\t\t\t\t'.wp-block-prc-block-table-of-contents__list .wp-block-prc-block-table-of-contents__list'\n\t\t\t);\n\t\t},\n\t\tinitSmoothScrollClickHandler: () => {\n\t\t\tconst internalChaptersList = actions.getInternalChaptersList();\n\n\t\t\tif (!internalChaptersList) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst links = internalChaptersList.querySelectorAll('a');\n\n\t\t\tif (!links) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tlinks.forEach((link) => {\n\t\t\t\tlink.addEventListener('click', (e) => {\n\t\t\t\t\tconst href = link.getAttribute('href');\n\t\t\t\t\t// If the link is a hash link, we need to smooth scroll to the hash.\n\t\t\t\t\tif (0 === href.indexOf('#')) {\n\t\t\t\t\t\te.preventDefault();\n\t\t\t\t\t\tconst target = document.getElementById(\n\t\t\t\t\t\t\thref.replace('#', '')\n\t\t\t\t\t\t);\n\t\t\t\t\t\tif (target) {\n\t\t\t\t\t\t\ttarget.scrollIntoView({ behavior: 'smooth' }, true);\n\t\t\t\t\t\t\t// Add the hash to the end of the URL.\n\t\t\t\t\t\t\twindow.history.pushState(null, null, href);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t});\n\t\t},\n\t\tonDropdownClick: (event) => {\n\t\t\tevent.preventDefault();\n\t\t\tconst context = getContext();\n\t\t\tcontext.isDropdownOpen = !context.isDropdownOpen;\n\t\t},\n\t},\n\tcallbacks: {\n\t\tonInit: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tactions.initSmoothScrollClickHandler();\n\n\t\t\t// So long as there is one TOC block that has this enabled we will enable the watch for chapter scroll function.\n\t\t\tconst { showCurrentChapter } = context;\n\t\t\tif (true === showCurrentChapter) {\n\t\t\t\tconst { postId } = state;\n\t\t\t\t// get the object our of state.chapters with the same id as the postId\n\t\t\t\tconst thisChapter =\n\t\t\t\t\tstate.chapters.find((chapter) => chapter.id === postId) ||\n\t\t\t\t\t{};\n\t\t\t\tconst internalChapters = thisChapter?.internal_chapters || [];\n\n\t\t\t\tstate.enableWatchForChapterScroll = true;\n\t\t\t\tstate.chaptersWatchList = internalChapters;\n\t\t\t}\n\t\t},\n\t\tonResize: () => {\n\t\t\tconst context = getContext();\n\t\t\tconst { autoDropdownEnabled, autoDropdownWidth } = context;\n\t\t\tif (!autoDropdownEnabled) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconst { ref } = getElement();\n\t\t\t// get the width of the ref\n\t\t\tconst width = ref.offsetWidth;\n\t\t\t// if the width is less than the autoDropdownWidth and autoDropdownEnabled is true\n\t\t\t// set isDropdown to true\n\t\t\tif (width < autoDropdownWidth && autoDropdownEnabled) {\n\t\t\t\tcontext.isDropdown = true;\n\t\t\t} else {\n\t\t\t\tcontext.isDropdown = false;\n\t\t\t}\n\t\t},\n\t\tisListItemActive: () => {\n\t\t\tconst elm = getElement();\n\t\t\tconst { ref } = elm;\n\t\t\t// set const id to elm.data-ref-value but remove the # from the beginning\n\t\t\tconst id = ref?.getAttribute('data-ref-value')?.replace('#', '');\n\n\t\t\tif (id === state.currentChapter) {\n\t\t\t\treturn true;\n\t\t\t}\n\n\t\t\treturn false;\n\t\t},\n\t\twatchForChapterScroll: () => {\n\t\t\tif (!state.enableWatchForChapterScroll) {\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\t// get the current chapter\n\t\t\tlet { currentChapter, chapterEls } = state;\n\n\t\t\t// get the current scroll position\n\t\t\tconst scrollPosition = window.scrollY;\n\n\t\t\tconst debounce = (func, wait) => {\n\t\t\t\tlet timeout;\n\t\t\t\treturn function executedFunction(...args) {\n\t\t\t\t\tconst later = () => {\n\t\t\t\t\t\ttimeout = null;\n\t\t\t\t\t\tfunc(...args);\n\t\t\t\t\t};\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\ttimeout = setTimeout(later, wait);\n\t\t\t\t};\n\t\t\t};\n\n\t\t\tconst getCurrentChapter = debounce(() => {\n\t\t\t\t// iterate over the chapterEls array backwards\n\t\t\t\t// if the top of the chapter is less than the scroll position\n\t\t\t\t// set the currentChapter to the id of the chapter\n\t\t\t\tcurrentChapter = null;\n\t\t\t\tif (!chapterEls || chapterEls.length === 0) {\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tfor (let i = chapterEls.length - 1; i >= 0; i--) {\n\t\t\t\t\tconst chapterTop = chapterEls[i].offsetTop;\n\t\t\t\t\tif (scrollPosition > chapterTop) {\n\t\t\t\t\t\tcurrentChapter = chapterEls[i].id;\n\t\t\t\t\t\tif (currentChapter !== state.currentChapter) {\n\t\t\t\t\t\t\tstate.currentChapter = currentChapter;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}, 300);\n\n\t\t\tgetCurrentChapter();\n\t\t},\n\t\tonWindowClick: (event) => {\n\t\t\tconst context = getContext();\n\t\t\tconst { ref } = getElement();\n\t\t\tif (!ref.contains(event.target) && context.isDropdown) {\n\t\t\t\tcontext.isDropdownOpen = false;\n\t\t\t}\n\t\t},\n\t},\n});\n"],"names":["__webpack_require__","exports","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","y","__WEBPACK_EXTERNAL_MODULE__wordpress_interactivity_8e89b257__","x","d","actions","state","store","chapterEls","chaptersWatchList","map","chapter","document","getElementById","id","getInternalChaptersList","ref","getElement","querySelector","initSmoothScrollClickHandler","internalChaptersList","links","querySelectorAll","forEach","link","addEventListener","e","href","getAttribute","indexOf","preventDefault","target","replace","scrollIntoView","behavior","window","history","pushState","onDropdownClick","event","context","getContext","isDropdownOpen","callbacks","onInit","showCurrentChapter","postId","thisChapter","chapters","find","internalChapters","internal_chapters","enableWatchForChapterScroll","onResize","autoDropdownEnabled","autoDropdownWidth","width","offsetWidth","isDropdown","isListItemActive","elm","currentChapter","watchForChapterScroll","scrollPosition","scrollY","debounce","func","wait","timeout","args","clearTimeout","setTimeout","later","length","i","chapterTop","offsetTop","getCurrentChapter","onWindowClick","contains"],"sourceRoot":""}