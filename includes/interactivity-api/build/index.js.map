{"version":3,"file":"index.js","mappings":"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","sources":["webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"hooks\"]","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"compose\"]","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"element\"]","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"data\"]","webpack://prc-block-library-interactivity-api-controls/external window \"prcIcons\"","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"i18n\"]","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"blockEditor\"]","webpack://prc-block-library-interactivity-api-controls/external window [\"wp\",\"components\"]","webpack://prc-block-library-interactivity-api-controls/external window \"ReactJSXRuntime\"","webpack://prc-block-library-interactivity-api-controls/./src/controls.jsx","webpack://prc-block-library-interactivity-api-controls/./src/index.js"],"sourcesContent":["const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"hooks\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"compose\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"element\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"data\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"prcIcons\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"i18n\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"blockEditor\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"wp\"][\"components\"];","const __WEBPACK_NAMESPACE_OBJECT__ = window[\"ReactJSXRuntime\"];","// Add isInteractive toggle and interactiveContext text control to all blocks where supports.interactivity === true.\n\n/**\n * External Dependencies\n */\nimport { Icon } from '@prc/icons';\n\n/**\n * WordPress Dependencies\n */\nimport { __ } from '@wordpress/i18n';\nimport { Fragment, useEffect } from '@wordpress/element';\nimport { InspectorControls } from '@wordpress/block-editor';\nimport {\n\tBaseControl,\n\tSelectControl,\n\tExternalLink,\n\tTextControl,\n\tToggleControl,\n\tPanelBody,\n} from '@wordpress/components';\nimport { useSelect, select } from '@wordpress/data';\n\n/**\n * Internal Dependencies\n */\n\nfunction InspectorPanel({ attributes, setAttributes, clientId, context }) {\n\tconst { interactiveNamespace, interactiveSubsumption } = attributes;\n\tconst targetNamespace = interactiveNamespace || context?.interactiveNamespace;\n\tconst { interactiveNamespaceOptions, defaultNamespace } = useSelect(\n\t\t(select) => {\n\t\t\tconst { getBlockParents, getBlock } = select('core/block-editor');\n\t\t\tconst { getBlockSupport } = select('core/blocks');\n\t\t\tconst _blockNames = getBlockParents(clientId);\n\t\t\tconst blockArray = [];\n\t\t\t_blockNames.forEach((block) => {\n\t\t\t\tconst _block = getBlock(block);\n\t\t\t\tconst blockName = _block.name;\n\t\t\t\tconst supportsInteractivity = getBlockSupport(\n\t\t\t\t\tblockName,\n\t\t\t\t\t'interactivity'\n\t\t\t\t);\n\t\t\t\tif (supportsInteractivity) {\n\t\t\t\t\tif (!blockArray.includes(blockName)) {\n\t\t\t\t\t\tblockArray.push(blockName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\n\t\t\t// Construct new options array for a select control with the names.\n\t\t\tconst options = [\n\t\t\t\t{\n\t\t\t\t\tvalue: null,\n\t\t\t\t\tlabel: 'None',\n\t\t\t\t},\n\t\t\t\t...blockArray.map((blockName) => ({\n\t\t\t\t\tvalue: blockName,\n\t\t\t\t\tlabel: blockName,\n\t\t\t\t})),\n\t\t\t];\n\n\t\t\treturn {\n\t\t\t\tinteractiveNamespaceOptions: options,\n\t\t\t\tdefaultNamespace: options[0]?.value,\n\t\t\t};\n\t\t},\n\t\t[clientId]\n\t);\n\n\treturn (\n\t\t<InspectorControls>\n\t\t\t<PanelBody\n\t\t\t\ttitle={__('Interactivity API')}\n\t\t\t\tinitialOpen={false}\n\t\t\t\tbuttonProps={{\n\t\t\t\t\tisDestructive:\n\t\t\t\t\t\t(targetNamespace?.length > 0 || interactiveSubsumption),\n\t\t\t\t\ticon: (\n\t\t\t\t\t\t<div style={{ paddingLeft: '0.25em', color: 'inherit' }}>\n\t\t\t\t\t\t\t<Icon\n\t\t\t\t\t\t\t\ticon=\"plug-circle-bolt\"\n\t\t\t\t\t\t\t\tsize=\"1em\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t),\n\t\t\t\t}}\n\t\t\t>\n\t\t\t\t<div>\n\t\t\t\t\t<ToggleControl\n\t\t\t\t\t\tlabel={__('Subsumption', 'prc-block-library')}\n\t\t\t\t\t\tchecked={interactiveSubsumption}\n\t\t\t\t\t\tonChange={() =>\n\t\t\t\t\t\t\tsetAttributes({\n\t\t\t\t\t\t\t\tinteractiveSubsumption:\n\t\t\t\t\t\t\t\t\t!interactiveSubsumption,\n\t\t\t\t\t\t\t\t// interactiveNamespace: null,\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\thelp={__(\n\t\t\t\t\t\t\t'When enabled, this block will inherit primitives like name, value, and type directly. This is useful for blocks that are used inside interactive templates (<template/>).',\n\t\t\t\t\t\t\t'prc-block-library'\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t<SelectControl\n\t\t\t\t\t\tlabel={__('Target Namespace', 'prc-block-library')}\n\t\t\t\t\t\tvalue={targetNamespace}\n\t\t\t\t\t\toptions={interactiveNamespaceOptions}\n\t\t\t\t\t\tonChange={(newNamespace) =>\n\t\t\t\t\t\t\tsetAttributes({\n\t\t\t\t\t\t\t\tinteractiveNamespace: newNamespace\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t}\n\t\t\t\t\t\thelp={__(\n\t\t\t\t\t\t\t`The target namespace uniquely identifies this block's interactivity context, ensuring interactions remain within the block and its parent. You can see parent blocks that support interactivity, which this block can \"hook\" into. If you don't see the desired namespace, it means the parent block does not support interactivity.`,\n\t\t\t\t\t\t\t'prc-block-library'\n\t\t\t\t\t\t)}\n\t\t\t\t\t/>\n\t\t\t\t\t<ExternalLink href=\"https://developer.wordpress.org/block-editor/reference-guides/interactivity-api/api-reference/\">\n\t\t\t\t\t\tAPI documentation\n\t\t\t\t\t</ExternalLink>\n\t\t\t\t</div>\n\t\t\t</PanelBody>\n\t\t</InspectorControls>\n\t);\n}\n\nexport default function Controls({\n\tattributes,\n\tsetAttributes,\n\tclientId,\n\tcontext,\n}) {\n\treturn (\n\t\t<InspectorPanel {...{ attributes, setAttributes, clientId, context }} />\n\t);\n}\n","/* eslint-disable max-len */\n/**\n * WordPress Dependencies\n */\nimport { addFilter } from '@wordpress/hooks';\nimport { createHigherOrderComponent } from '@wordpress/compose';\nimport { Fragment } from '@wordpress/element';\nimport { useSelect } from '@wordpress/data';\n\n/**\n * Internal Dependencies\n */\nimport Controls from './controls';\n\nconst BLOCKIDENTIFIER = 'prc-block/interactivity-api';\n\n/**\n * Add the interactivity api controls to all blocks that support block.\n */\naddFilter(\n\t'editor.BlockEdit',\n\t`${BLOCKIDENTIFIER}-controls`,\n\tcreateHigherOrderComponent(\n\t\t(BlockEdit) =>\n\t\t\tfunction BlockInteractivityControls(props) {\n\t\t\t\tconst {\n\t\t\t\t\tname,\n\t\t\t\t\tattributes,\n\t\t\t\t\tsetAttributes,\n\t\t\t\t\tclientId,\n\t\t\t\t\tisSelected,\n\t\t\t\t\tcontext,\n\t\t\t\t} = props;\n\n\t\t\t\tconst supportsInteractivity = useSelect(\n\t\t\t\t\t(select) =>\n\t\t\t\t\t\tselect('core/blocks').getBlockSupport(\n\t\t\t\t\t\t\tname,\n\t\t\t\t\t\t\t'interactivity'\n\t\t\t\t\t\t),\n\t\t\t\t\t[name]\n\t\t\t\t);\n\n\t\t\t\tif (!supportsInteractivity || !isSelected) {\n\t\t\t\t\treturn <BlockEdit {...props} />;\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t<BlockEdit {...props} />\n\t\t\t\t\t\t<Controls\n\t\t\t\t\t\t\t{...{\n\t\t\t\t\t\t\t\tattributes,\n\t\t\t\t\t\t\t\tsetAttributes,\n\t\t\t\t\t\t\t\tclientId,\n\t\t\t\t\t\t\t\tcontext,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t/>\n\t\t\t\t\t</Fragment>\n\t\t\t\t);\n\t\t\t},\n\t\t'withPRCBlockInteractivityAPIControls'\n\t),\n\t100\n);\n\naddFilter(\n\t'blocks.registerBlockType',\n\t`${BLOCKIDENTIFIER}-supports`,\n\t(settings) => {\n\t\tif (settings?.supports?.interactivity) {\n\t\t\tsettings.attributes = {\n\t\t\t\t...settings.attributes,\n\t\t\t\tinteractiveNamespace: {\n\t\t\t\t\ttype: 'string',\n\t\t\t\t},\n\t\t\t\tinteractiveSubsumption: {\n\t\t\t\t\ttype: 'boolean',\n\t\t\t\t\tdefault: false,\n\t\t\t\t},\n\t\t\t};\n\t\t\tsettings.usesContext = [\n\t\t\t\t...settings.usesContext,\n\t\t\t\t'interactiveNamespace',\n\t\t\t];\n\t\t}\n\n\t\treturn settings;\n\t},\n\t100\n);\n"],"names":["window","InspectorPanel","attributes","setAttributes","clientId","context","interactiveNamespace","interactiveSubsumption","targetNamespace","interactiveNamespaceOptions","defaultNamespace","useSelect","select","getBlockParents","getBlock","getBlockSupport","_blockNames","blockArray","forEach","block","blockName","name","includes","push","options","value","label","map","_jsx","InspectorControls","children","PanelBody","title","__","initialOpen","buttonProps","isDestructive","length","icon","style","paddingLeft","color","Icon","size","_jsxs","ToggleControl","checked","onChange","help","SelectControl","newNamespace","ExternalLink","href","Controls","BLOCKIDENTIFIER","addFilter","createHigherOrderComponent","BlockEdit","props","isSelected","Fragment","settings","supports","interactivity","type","default","usesContext"],"sourceRoot":""}